# Filesystem Hierarchy

## Overview

Файловая система Linux - это организованная структура, в которой хранятся все файлы и папки. Понимание структуры файловой системы критично для эффективной работы в Linux.

**Что вы узнаете:**
- Стандартная структура директорий (FHS)
- Назначение основных папок
- Команды для навигации и работы с файлами
- Как искать файлы в системе
- Типы файлов и символические ссылки
- Решение типичных проблем

## Prerequisites

Перед этим разделом нужно:
- Базовое понимание файловой системы
- Знание что такое директории (папки) и файлы
- Понимание путей к файлам (абсолютные и относительные)

## Linux Filesystem Hierarchy Standard (FHS)

Все дистрибутивы Linux следуют одному стандарту - **FHS (Filesystem Hierarchy Standard)**. Это означает, что структура одна и та же везде.

### Main Directory Structure

```
/                          корень системы (root)
├── /bin/                  основные команды (ls, cp, grep, cat, etc)
├── /sbin/                 системные команды только для root (ifconfig, iptables)
├── /boot/                 kernel и bootloader (GRUB, инициализация)
├── /dev/                  файлы устройств (диски sda, терминалы tty, и т.д.)
├── /etc/                  конфигурационные файлы системы
│   ├── /etc/passwd        информация о пользователях
│   ├── /etc/shadow        пароли (только root)
│   ├── /etc/group         информация о группах
│   └── /etc/hosts         локальные DNS записи
├── /home/                 домашние папки пользователей
│   └── /home/username/    папка конкретного пользователя
├── /root/                 домашняя папка root пользователя
├── /lib/, /lib64/         системные библиотеки
├── /usr/                  пользовательские программы
│   ├── /usr/bin/          пользовательские команды
│   ├── /usr/sbin/         пользовательские системные команды
│   ├── /usr/local/        локально установленное ПО (ваше, не из репозитория)
│   └── /usr/share/        общие данные (иконки, документация, шрифты)
├── /var/                  переменные данные (всё что меняется)
│   ├── /var/log/          логи системы и приложений
│   ├── /var/cache/        кэши приложений
│   └── /var/tmp/          временные файлы приложений
├── /tmp/                  временные файлы пользователей (очищается при перезагрузке)
├── /proc/                 информация о процессах (виртуальная ФС)
├── /sys/                  информация о системе и драйверах (виртуальная ФС)
├── /run/                  runtime данные (PID файлы, sockets)
├── /opt/                  программы третьих сторон (большие приложения)
├── /srv/                  данные сервисов
├── /media/                точки монтирования съёмных носителей (USB, CD)
└── /mnt/                  точки монтирования (временные маунты)
```

### Важные файлы в /etc/

```
/etc/passwd                пользователи системы (формат: user:x:uid:gid:name:home:shell)
/etc/shadow                хешированные пароли (только root может читать!)
/etc/group                 группы и их члены
/etc/sudoers               кто может использовать sudo
/etc/hostname              имя компьютера
/etc/hosts                 локальные DNS записи (127.0.0.1 localhost)
/etc/fstab                 какие диски монтировать при загрузке
/etc/systemd/system/       файлы сервисов systemd
/etc/apt/sources.list      репозитории пакетов (Debian/Ubuntu)
/etc/yum.repos.d/          репозитории пакетов (Fedora/RHEL)
```

## Navigation Commands

### Основные команды навигации

**Текущая директория:**
```bash
pwd                        # print working directory - где я сейчас?
```

**Список файлов:**
```bash
ls                         # список файлов в текущей папке
ls -l                      # детальный список (права, владелец, размер)
ls -la                     # включая скрытые файлы (начинаются с .)
ls -lh                     # размеры в человеческом формате (K, M, G)
ls -lS                     # отсортировано по размеру
ls -lt                     # отсортировано по времени изменения
ls /path/to/dir            # список в конкретной папке
```

**Смена директории:**
```bash
cd /path/to/dir            # перейти в папку
cd ~                       # в домашнюю папку текущего пользователя
cd /root                   # в домашнюю папку root
cd -                       # в предыдущую посещённую папку
cd ..                      # на уровень выше
cd ../..                   # на два уровня выше
```

## File Operations

### Просмотр содержимого файлов

```bash
cat file.txt               # показать содержимое (весь файл сразу)
cat file1 file2            # объединить два файла
head -n 10 file            # первые 10 строк
tail -n 10 file            # последние 10 строк
tail -f file               # просмотр в реальном времени (для логов)
less file                  # постраничный просмотр (q для выхода, Space/Page Down для листания)
more file                  # старая версия less
wc -l file                 # количество строк
file file.txt              # определить тип файла
```

### Создание файлов и папок

```bash
touch file.txt             # создать пустой файл (или обновить время)
mkdir folder               # создать папку
mkdir -p a/b/c             # создать вложенные папки (родителей не нужно)
mkdir -m 755 folder        # с определённными правами
```

### Копирование, перемещение, удаление

```bash
cp file1 file2             # скопировать файл
cp -r dir1 dir2            # копировать папку рекурсивно
cp -i file1 file2          # с подтверждением перед перезаписью
mv old_name new_name       # переименовать или переместить
mv -i file newdir/         # с подтверждением
rm file                    # удалить файл
rm -r dir                  # удалить папку рекурсивно (с содержимым!)
rm -i file                 # с подтверждением перед удалением
rmdir dir                  # удалить пустую папку только
```

⚠️ **ВАЖНО:** В Linux нет "Корзины" для `rm` - удаление необратимо!

### Поиск файлов

```bash
find /path -name "pattern"        # найти по названию
find /path -type f -name "*.txt"  # только файлы с расширением .txt
find /path -type d -name "logs"   # только папки с названием "logs"
find /path -user username         # файлы, принадлежащие пользователю
find /path -size +1M              # файлы больше 1 MB
find /path -mtime -7              # файлы, изменённые за последние 7 дней
locate filename                   # быстрый поиск (требует updatedb)
which command                     # где находится команда
whereis command                   # где находится команда, исходный код, справка
grep "text" file                  # найти строку в файле
grep -r "text" /path              # рекурсивный поиск
grep -i "text" file               # без учёта регистра
```

## File System Information

### Информация о диском пространстве

```bash
df                         # дисковое пространство всех смонтированных систем
df -h                      # в человеческом формате (G, M, K)
df -h /home                # информация о конкретной папке
du -sh folder              # размер папки
du -sh *                   # размер всех файлов/папок в текущей директории
du -sh * | sort -h         # отсортировано по размеру
du -sh * | sort -rh        # от большего к меньшему
```

### Информация о дисках и разделах

```bash
lsblk                      # список блочных устройств (диски, разделы)
fdisk -l                   # детали разделов (требует sudo)
parted -l                  # альтернатива fdisk (требует sudo)
mount                      # какие системы смонтированы
mount /dev/sda1 /mnt/      # смонтировать раздел
umount /mnt                # отмонтировать
```

## Paths: Absolute and Relative

### Абсолютные пути (Absolute Paths)

Начинаются с `/` и работают из любой директории:

```bash
/home/user/documents       # полный путь от корня
/etc/config                # конфиг в /etc
/var/log/nginx/access.log  # логи nginx
```

**Используйте когда:**
- Указываете точный путь
- Пишете скрипты
- Работаете из разных директорий

### Относительные пути (Relative Paths)

Без `/` в начале, от текущей позиции:

```bash
./file                     # файл в текущей папке
../file                    # файл на уровень выше
../../dir/file             # два уровня выше, потом в папку dir
./subdir/file              # в подпапке текущей папки
documents/report.pdf       # в папке documents текущей папки
```

**Символы:**
- `.` — текущая директория
- `..` — родительская директория
- `~` — домашняя папка текущего пользователя

## Symbolic Links

**Символические ссылки** - это как "ярлыки" на файлы или папки.

```bash
ln -s /path/to/original link_name    # создать символическую ссылку
ls -l                                # ссылка показывается стрелкой ->
rm link_name                         # удалить ссылку (оригинал остаётся!)
```

**Пример:**
```bash
ln -s /var/log/nginx/access.log access_log
# Теперь можно: cat access_log вместо cat /var/log/nginx/access.log
```

**Когда использовать:**
- Доступ к файлу из нескольких мест
- Альтернативные имена для команд
- Версионирование (текущая версия ссылка на стабильную)

## Hidden Files and Directories

**Скрытые файлы** начинаются с точки `.`:

```bash
.bashrc                    # конфиг shell
.gitignore                 # Git конфиг
.config/                   # конфиги приложений
.ssh/                      # SSH ключи и конфиги
.cache/                    # кэши приложений
```

**Просмотр скрытых файлов:**
```bash
ls -a                      # показать все, включая скрытые
ls -la                     # подробно, включая скрытые
```

## File Types

В Linux почти всё - это файлы. Есть разные типы:

| Символ | Тип | Описание |
|--------|-----|---------|
| `-` | Regular file | Обычный файл (текст, binary, и т.д.) |
| `d` | Directory | Папка |
| `l` | Symbolic link | Символическая ссылка (->target) |
| `b` | Block device | Блочное устройство (диск /dev/sda) |
| `c` | Character device | Символьное устройство (терминал /dev/tty) |
| `s` | Socket | Socket для межпроцессной коммуникации |
| `p` | FIFO/Pipe | Именованный pipe для ввода-вывода |

**Проверить тип:**
```bash
ls -l file                 # первый символ показывает тип
file file                  # определить тип файла
stat file                  # детали файла
```

## Permissions Overview

Каждый файл имеет права доступа:

```
-rw-r--r--  1  user group  1024  Jan 6 10:23  file.txt
^          ^  ^    ^    ^
тип        hardlinks owner group
```

**Права** (будут подробнее в разделе 02):
- `r` (read) = 4 — читать файл
- `w` (write) = 2 — писать в файл
- `x` (execute) = 1 — выполнять файл (команда)

Для **папок**:
- `r` — просмотреть список файлов
- `w` — создавать/удалять файлы в папке
- `x` — входить в папку

## Troubleshooting

### Файл или папка не найдена

```bash
# Поищите везде в home папке
find ~ -name "filename"

# Если знаете примерное названия
find ~ -name "*search*"

# Быстрый поиск (если updatedb запущен)
locate filename

# Где находится команда
which command
whereis command
```

### Нет доступа к файлу

```bash
# Посмотрите права
ls -l file
stat file

# Если вы владелец файла:
chmod u+r file             # добавить себе права на чтение

# Если нужны права другого пользователя:
sudo cat file
```

### Дисковое пространство кончилось

```bash
# Где используется место?
df -h                      # по файловым системам

# Большие папки
du -sh /home /var /opt | sort -h

# Особенно часто место занимает:
sudo du -sh /var/log/*     # логи
sudo du -sh /tmp           # временные файлы
apt list --installed | wc -l  # сколько пакетов установлено
```

### Запутались в директориях

```bash
pwd                        # где я?
cd ~                       # в домашнюю папку
ls -la                     # что здесь?
```

## Useful Paths Cheat Sheet

```bash
~                          домашняя папка (/home/username)
/                          корень системы
/home/user                 домашняя папка конкретного пользователя
/root                      домашняя папка root
/etc                       системные конфиги
/var/log                   логи системы
/tmp                       временные файлы (удаляются при перезагрузке)
/opt                       программы третьих сторон
/usr/local                 локально установленное ПО
/boot                      kernel и загрузчик
.                          текущая директория
..                         родительская директория
```

## Key Takeaways

- **FHS** - стандартная структура одинакова на всех дистрибутивах Linux
- **pwd, cd, ls** - три основные команды навигации
- **Абсолютные пути** начинаются с `/`, работают везде
- **Относительные пути** от текущей позиции, компактнее
- **Скрытые файлы** начинаются с `.`, показываются через `ls -a`
- **find** - мощный инструмент для поиска
- **Нет Корзины** в Linux - `rm` удаляет необратимо!

## Related

Следующий шаг:
- [[02-users-groups-permissions|Users, Groups, and Permissions]] — управление доступом

Предыдущий раздел:
- [[docs/linux/01-core-concepts/README|Core Concepts Index]] — полный индекс этого раздела

## See Also

Встроенная справка:
- `man ls` — справка по ls
- `man find` — справка по find
- `man hier` — подробная информация о FHS структуре
- `help cd` — справка по встроенным командам
