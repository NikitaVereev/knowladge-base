---
title: 02 Dockerfile - –æ—Å–Ω–æ–≤—ã
---

–ù–∞–ø–∏—Å–∞–Ω–∏–µ Dockerfile –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö Docker –æ–±—Ä–∞–∑–æ–≤.

---

## –ß—Ç–æ —Ç–∞–∫–æ–µ Dockerfile

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:**
- –¢–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ –¥–ª—è —Å–±–æ—Ä–∫–∏ Docker –æ–±—Ä–∞–∑–∞
- –ö–∞–∂–¥–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–π —Å–ª–æ–π
- –§–æ—Ä–º–∞—Ç: `–ò–ù–°–¢–†–£–ö–¶–ò–Ø –∞—Ä–≥—É–º–µ–Ω—Ç—ã`

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```dockerfile
# –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
FROM –±–∞–∑–æ–≤—ã–π_–æ–±—Ä–∞–∑
RUN –∫–æ–º–∞–Ω–¥–∞
COPY —Ñ–∞–π–ª /–ø—É—Ç—å
...
```

---

## –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞

**–ö–æ–º–∞–Ω–¥–∞ docker build:**
```bash
docker build -t myapp:1.0 .                       # —Å —Ç–µ–≥–æ–º
docker build -t myapp:latest -t myapp:1.0 .       # –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–µ–≥–æ–≤
docker build -f Dockerfile.prod -t app:prod .     # –¥—Ä—É–≥–æ–π —Ñ–∞–π–ª
docker build --build-arg NODE_ENV=production .    # —Å –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `-t, --tag` ‚Äî –∏–º—è –∏ —Ç–µ–≥ –æ–±—Ä–∞–∑–∞
- `-f, --file` ‚Äî –ø—É—Ç—å –∫ Dockerfile (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `./Dockerfile`)
- `--build-arg` ‚Äî –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Å–±–æ—Ä–∫–∏
- `.` (—Ç–æ—á–∫–∞) ‚Äî –∫–æ–Ω—Ç–µ–∫—Å—Ç —Å–±–æ—Ä–∫–∏ (–æ–±—ã—á–Ω–æ —Ç–µ–∫—É—â–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è)

**–ö–æ–Ω—Ç–µ–∫—Å—Ç —Å–±–æ—Ä–∫–∏:**
- –§–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ Docker –º–æ–∂–µ—Ç –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –æ–±—Ä–∞–∑
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è Docker daemon'—É
- –ë–æ–ª—å—à–æ–π –∫–æ–Ω—Ç–µ–∫—Å—Ç = –º–µ–¥–ª–µ–Ω–Ω–µ–µ —Å–±–æ—Ä–∫–∞

---

## .dockerignore —Ñ–∞–π–ª

**–ò—Å–∫–ª—é—á–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:**
```dockerfile
# .dockerignore
node_modules
npm-debug.log
.git
.gitignore
.env
.DS_Store
*.log
coverage/
dist/
build/
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ú–µ–Ω—å—à–µ —Ä–∞–∑–º–µ—Ä –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- –ë—ã—Å—Ç—Ä–µ–µ —Å–±–æ—Ä–∫–∞
- –ë–µ–∑–æ–ø–∞—Å–Ω–µ–µ (–∏—Å–∫–ª—é—á–∞—é—Ç—Å—è .env —Ñ–∞–π–ª—ã)

---

## –û—Å–Ω–æ–≤–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ Dockerfile

#### FROM (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è, –ø–µ—Ä–≤–∞—è)

```dockerfile
FROM ubuntu:22.04                    # –±–∞–∑–æ–≤—ã–π –æ–±—Ä–∞–∑
FROM node:18-alpine                  # Node.js –Ω–∞ Alpine Linux
FROM python:3.11-slim                # Python –Ω–∞ Debian
FROM scratch                          # –ø—É—Å—Ç–æ–π –æ–±—Ä–∞–∑ (–¥–ª—è –±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤)
```

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ:**
- –ü–µ—Ä–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –≤ Dockerfile
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –±–∞–∑–æ–≤—ã–π —Å–ª–æ–π –¥–ª—è –≤—Å–µ—Ö —Å–ª–µ–¥—É—é—â–∏—Ö –∫–æ–º–∞–Ω–¥

---

#### WORKDIR (—Ä–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è)

```dockerfile
WORKDIR /app                         # —Å–æ–∑–¥–∞—ë—Ç /app –∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç —Ç—É–¥–∞
WORKDIR backend                      # –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å –æ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –°–æ–∑–¥–∞—ë—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ä–∞–±–æ—á—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –∫–æ–º–∞–Ω–¥
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ RUN, COPY, CMD, –∏ —Ç.–¥.

---

#### COPY / ADD (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤)

**COPY (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):**
```dockerfile
COPY package.json .                  # –∫–æ–ø–∏—Ä—É–µ—Ç –≤ WORKDIR
COPY . .                              # –∫–æ–ø–∏—Ä—É–µ—Ç –≤—Å—ë –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
COPY app.js src/                      # –∫–æ–ø–∏—Ä—É–µ—Ç –≤ src/ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
```

**ADD (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏):**
```dockerfile
ADD https://example.com/file.tar.gz . # –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ URL
ADD file.tar.gz .                     # –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø–∞–∫–æ–≤–∞—Ç—å
```

**–†–∞–∑–Ω–∏—Ü–∞:**
- COPY –ø—Ä–æ—Å—Ç–æ –∫–æ–ø–∏—Ä—É–µ—Ç —Ñ–∞–π–ª—ã
- ADD –º–æ–∂–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å —Å URL –∏ —Ä–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞—Ç—å –∞—Ä—Ö–∏–≤—ã
- COPY –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–µ–µ –¥–ª—è —è—Å–Ω–æ—Å—Ç–∏

---

#### RUN (–≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥)

```dockerfile
RUN apt-get update && apt-get install -y nginx     # –∫–æ–º–∞–Ω–¥–∞ shell
RUN ["npm", "install"]                             # exec —Ñ–æ—Ä–º–∞
RUN npm install && npm run build                    # –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ–º–∞–Ω–¥
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é `/bin/sh -c` (shell —Ñ–æ—Ä–º–∞)
- Exec —Ñ–æ—Ä–º–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç shell: `["executable", "param1", "param2"]`

**Best practice:**
- –ì—Ä—É–ø–ø–∏—Ä—É–π RUN –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è —Å–ª–æ—ë–≤
- –û—á–∏—â–∞–π –∫—ç—à –ø–∞–∫–µ—Ç–æ–≤: `apt-get clean && rm -rf /var/lib/apt/lists/*`

```dockerfile
# –ü–ª–æ—Ö–æ (–º–Ω–æ–≥–æ —Å–ª–æ—ë–≤)
RUN apt-get update
RUN apt-get install -y curl
RUN apt-get install -y git

# –•–æ—Ä–æ—à–æ (–æ–¥–∏–Ω —Å–ª–æ–π)
RUN apt-get update && apt-get install -y \
    curl \
    git \
    && rm -rf /var/lib/apt/lists/*
```

---

#### ENV (–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è)

```dockerfile
ENV NODE_ENV production
ENV PORT 3000
ENV DATABASE_URL postgresql://localhost/mydb
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –∏ –ø—Ä–∏ —Å–±–æ—Ä–∫–µ
- –ú–æ–∂–µ—à—å –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ: `docker run -e NODE_ENV=dev`

---

#### EXPOSE (–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤)

```dockerfile
EXPOSE 3000
EXPOSE 3000 5432
```

**–í–∞–∂–Ω–æ:**
- –≠—Ç–æ –ø—Ä–æ—Å—Ç–æ **–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**, –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø–æ—Ä—Ç
- –î–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –∏—Å–ø–æ–ª—å–∑—É–π `docker run -p 3000:3000`
- –ü–æ–º–æ–≥–∞–µ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º –ø–æ–Ω—è—Ç—å –∫–∞–∫–æ–π –ø–æ—Ä—Ç –Ω—É–∂–µ–Ω

---

#### USER (—Å–º–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)

```dockerfile
USER nobody                          # –Ω–µ–ø—Ä–∏–≤–∞—Ç–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
USER appuser                         # —Å–æ–∑–¥–∞–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–µ—Ä–µ–¥ —ç—Ç–∏–º
```

**Best practice:**
- –ó–∞–ø—É—Å–∫–∞–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ—Ç –Ω–µ–ø—Ä–∏–≤–∞—Ç–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ò–∑–±–µ–≥–∞–π –∑–∞–ø—É—Å–∫–∞ –æ—Ç root

```dockerfile
RUN groupadd -r appuser && useradd -r -g appuser appuser
USER appuser
```

---

#### LABEL (–º–µ—Ç–∞–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è)

```dockerfile
LABEL version="1.0"
LABEL maintainer="dev@example.com"
LABEL description="My awesome app"
LABEL org.opencontainers.image.source=https://github.com/user/repo
```

---

## –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

#### CMD (–∫–æ–º–∞–Ω–¥–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

```dockerfile
CMD ["node", "app.js"]               # exec —Ñ–æ—Ä–º–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
CMD node app.js                       # shell —Ñ–æ—Ä–º–∞
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ú–æ–∂–µ—Ç –±—ã—Ç—å –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
- `docker run myapp npm test` –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç CMD
- –ú–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ CMD, –Ω–æ —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω—è—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è

---

#### ENTRYPOINT (—Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞)

```dockerfile
ENTRYPOINT ["node", "app.js"]        # exec —Ñ–æ—Ä–º–∞
ENTRYPOINT node app.js                # shell —Ñ–æ—Ä–º–∞
```

**–†–∞–∑–Ω–∏—Ü–∞ –æ—Ç CMD:**
- ENTRYPOINT –æ–±—ã—á–Ω–æ –Ω–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è
- `docker run myapp --help` –ø–µ—Ä–µ–¥–∞—Å—Ç `--help` –∫–∞–∫ –∞—Ä–≥—É–º–µ–Ω—Ç

---

#### ENTRYPOINT vs CMD

**–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```dockerfile
ENTRYPOINT ["npm"]
CMD ["start"]
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- `docker run myapp` –≤—ã–ø–æ–ª–Ω–∏—Ç: `npm start`
- `docker run myapp test` –≤—ã–ø–æ–ª–Ω–∏—Ç: `npm test`

**–¢–∞–±–ª–∏—Ü–∞:**

| ENTRYPOINT | CMD | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|-----------|-----|-----------|
| `node` | `app.js` | `node app.js` |
| `node` | ‚Äî | `node` |
| ‚Äî | `npm start` | `npm start` |
| `[node]` | `[app.js]` | `node app.js` |

---

#### ARG (–∞—Ä–≥—É–º–µ–Ω—Ç—ã —Å–±–æ—Ä–∫–∏)

```dockerfile
ARG NODE_VERSION=18
FROM node:${NODE_VERSION}-alpine

ARG BUILD_DATE
LABEL build.date=$BUILD_DATE
```

**–ü—Ä–∏ —Å–±–æ—Ä–∫–µ:**
```bash
docker build --build-arg NODE_VERSION=20 .
docker build --build-arg BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ') .
```

**–†–∞–∑–Ω–∏—Ü–∞ –æ—Ç ENV:**
- ARG –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –≤–æ –≤—Ä–µ–º—è —Å–±–æ—Ä–∫–∏
- ENV –¥–æ—Å—Ç—É–ø–µ–Ω –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ

---

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã

#### Node.js –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

```dockerfile
FROM node:18-alpine

WORKDIR /app

COPY package*.json ./
RUN npm ci --only=production

COPY . .

EXPOSE 3000

USER node

CMD ["node", "index.js"]
```

#### Python –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

```dockerfile
FROM python:3.11-slim

WORKDIR /app

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY . .

EXPOSE 8000

CMD ["python", "app.py"]
```

#### Go –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

```dockerfile
FROM golang:1.21-alpine AS builder

WORKDIR /app
COPY . .
RUN go build -o app .

FROM alpine:latest
COPY --from=builder /app/app .
CMD ["./app"]
```

---

## –ü–æ—Ä—è–¥–æ–∫ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π (–¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏)

**–•–æ—Ä–æ—à–∏–π –ø–æ—Ä—è–¥–æ–∫:**
```dockerfile
FROM node:18-alpine              # 1. –ë–∞–∑–æ–≤—ã–π –æ–±—Ä–∞–∑

WORKDIR /app                     # 2. –†–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è

ENV NODE_ENV production          # 3. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (—Ä–µ–¥–∫–æ –º–µ–Ω—è—é—Ç—Å—è)

COPY package*.json ./            # 4. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (—Ä–µ–¥–∫–æ –º–µ–Ω—è—é—Ç—Å—è)
RUN npm ci --only=production

COPY . .                          # 5. –ö–æ–¥ (—á–∞—Å—Ç–æ –º–µ–Ω—è–µ—Ç—Å—è)

EXPOSE 3000                       # 6. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

USER node                         # 7. Security

CMD ["node", "index.js"]          # 8. –ó–∞–ø—É—Å–∫
```

**–ü–æ—á–µ–º—É —Ç–∞–∫:**
- –ò–∑–º–µ–Ω—è—é—â–∏–µ—Å—è –≤–µ—â–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –∫–æ–Ω—Ü–µ
- –°–ª–æ–∏ –∫—ç—à–∏—Ä—É—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ
- –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–æ–¥–∞ –Ω–µ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

---

## üîó –°–≤—è–∑–∏

**–°–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑–¥–µ–ª:**
- [[03-build-optimize|03 –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–∑–æ–≤]]
