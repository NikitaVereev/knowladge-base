---
title: 01 Введение в Vagrant
---

---

## Проблема: Ручное Создание ВМ

```
❌ Ручной способ:
1. Открыть VirtualBox
2. Создать новую машину (5 минут)
3. Выбрать ОС (Linux/Ubuntu) (2 минут)
4. Выделить RAM и CPU (2 минут)
5. Создать виртуальный диск (3 минут)
6. Установить гостевую ОС (15+ минут)
7. Настроить сеть (5 минут)
8. Повторить 5 раз = 3+ часа для кластера
→ Скучно, ошибки, времязатратно

✓ Vagrant способ:
1. Написать Vagrantfile (5 минут)
2. vagrant up (ждать 10 минут)
→ 5 машин готовых к работе!
```

---

## Infrastructure as Code (IaC)

**Конфигурация как код:**
```ruby
# Vagrantfile
Vagrant.configure("2") do |config|
  config.vm.box = "ubuntu/jammy64"
  config.vm.provider "virtualbox" do |vb|
    vb.memory = 2048
    vb.cpus = 2
  end
end
```

**Преимущества:**
- Версионирование в Git
- Повторяемость (на любой машине одинаково)
- Масштабируемость (добавить машины одной строкой)
- Документирование (конфиг это документация)

---

## Что такое Vagrant

```
┌──────────────────────────────────────────────────┐
│                   Vagrant                         │
│  Инструмент для управления виртуальными машинами │
│                                                  │
│  • Создание ВМ по конфигу (Vagrantfile)         │
│  • Управление жизненным циклом                  │
│  • Подготовка к работе (provisioning)           │
│  • Работает с разными гипервизорами             │
└──────────────────────────────────────────────────┘
              ↓
    ┌─────────┴──────────┐
    ↓                    ↓
 VirtualBox          Hyper-V / KVM
  (рекомендуется)   (альтернативы)
```

---

## Vagrant vs Альтернативы

| Критерий | Vagrant | Terraform | Docker | VirtualBox |
|----------|---------|-----------|--------|-----------|
| ВМ локально | ✓ | ✗ | ✗ (контейнеры) | ✓ (GUI только) |
| Облако (AWS, Azure) | Ограничено | ✓✓ | Ограничено | ✗ |
| Configuration as Code | ✓ | ✓✓ | ✓ | ✗ |
| Простота обучения | Легко | Средне | Легко | Средне |
| Скорость создания | 10-15 мин | 5-10 мин | Секунды | 15-20 мин |
| Для разработки | ✓✓ | ✗ | ✓ | ✓ |
| Для production | Ограничено | ✓✓ | ✓ | ✗ |

**Итог:**
- **Vagrant:** разработка и тестирование локально
- **Terraform:** создание облачной инфраструктуры
- **Docker:** микросервисы и контейнеризация

---

## Архитектура Vagrant

```
┌────────────────────────────────────┐
│      ХОСТ МАШИНА                   │
│  (Твой ноутбук/сервер)            │
│                                    │
│  ┌──────────────────────────────┐ │
│  │ Vagrant (управление)         │ │
│  │ ├─ Vagrantfile (конфиг)      │ │
│  │ ├─ Provisioners (Ansible)    │ │
│  │ └─ Boxes (образы ВМ)         │ │
│  └──────────────────────────────┘ │
│              ↓                     │
│  ┌──────────────────────────────┐ │
│  │ VirtualBox (гипервизор)      │ │
│  └──────────────────────────────┘ │
│              ↓                     │
│  ┌───┬────┬────┬────┬────┐       │
│  │VM1│VM2 │VM3 │VM4 │VM5 │       │
│  │   │    │    │    │    │       │
│  │Ubu│Ubu │Ubu │Ubu │Ubu │       │
│  └───┴────┴────┴────┴────┘       │
└────────────────────────────────────┘
```

---

## Основные Компоненты

**1. VirtualBox**
- Гипервизор (создаёт виртуальные машины)
- Свободный и открытый источник
- Работает на Windows, Mac, Linux

**2. Vagrant**
- Инструмент управления ВМ
- Читает Vagrantfile конфигурацию
- Управляет жизненным циклом машин

**3. Vagrantfile**
- Конфигурация на Ruby языке
- Описывает машины (ОС, RAM, CPU, сеть)
- Может указывать provisioner'ы (Ansible, Shell скрипты)

**4. Boxes (Образы ВМ)**
- Предконфигурированные образы ОС
- Скачиваются с Vagrant Cloud или локально
- Пример: `ubuntu/jammy64`, `centos/8`, `debian/bookworm64`

---

## Требования

**На ХОЭ машине:**
- VirtualBox 6.0+ (гипервизор)
- Vagrant 2.3+ (инструмент)
- SSH клиент (встроен везде)
- Минимум 8GB RAM (для 1-2 машин)
- SSD рекомендуется

**На каждой ВМ:**
- Linux ОС (Ubuntu, CentOS, Debian)
- 1-2 CPU
- 512MB-2GB RAM
- 20GB диска

---

## Когда Использовать Vagrant

✓ **Идеально для:**
- Локальная разработка (dev окружение как в production)
- Тестирование конфигураций
- Обучение DevOps/Ansible/Docker
- Создание reproducible окружений
- Командная разработка (одинаковые ВМ для всех)

✗ **Не подходит для:**
- Production инфраструктуру (используй Terraform)
- Облачные ресурсы (используй Terraform)
- Масштабирование 100+ машин (используй Kubernetes)

---

## Workflow Разработчика

```
1. ИНИЦИАЛИЗАЦИЯ
   vagrant init ubuntu/jammy64
   ↓
2. РЕДАКТИРОВАНИЕ КОНФИГА
   vim Vagrantfile (указать RAM, CPU, provisioner)
   ↓
3. ЗАПУСК
   vagrant up (создаёт и запускает ВМ)
   ↓
4. РАЗРАБОТКА
   vagrant ssh (подключиться по SSH)
   vim/code (писать код)
   ↓
5. ТЕСТИРОВАНИЕ
   curl http://localhost:3000 (проверить сервис)
   ↓
6. ОСТАНОВКА
   vagrant halt (остановить)
   ↓
7. УДАЛЕНИЕ
   vagrant destroy (удалить когда больше не нужна)
```

---

## Advantages of Vagrant

✅ **Быстро**
- Создание машин в 10 минут
- Удаление за секунды

✅ **Reproducible**
- Одинаковые ВМ на разных машинах
- Git версионирование конфигурации

✅ **Масштабируемо**
- Добавить машин изменением одной строки
- Поддержка 1-5+ машин

✅ **Автоматизировано**
- Provisioner'ы (Ansible, Shell) выполняют команды
- Docker и приложения ставятся автоматически

✅ **Простое**
- Легко учиться
- Интуитивный синтаксис

---

**Следующее:** [[docs/_inbox/02-docker-ansible/07-ansible-foundamentals/02-installation|Установка и Конфигурация]]
