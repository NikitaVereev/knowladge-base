---
title: "6 Ansible Roles и Collections"
description: "Как организовать код с помощью ролей и коллекций. Структура каталогов и модульность."
---

По мере роста Playbook, хранить все задачи в одном файле становится неудобно. Ansible предлагает два уровня абстракции: **Roles** и **Collections**.

## Roles (Роли)

Роль — это способ автоматической загрузки переменных, задач, обработчиков и шаблонов, основанный на известной файловой структуре. Роль должна решать одну конкретную задачу (например, "Установка PostgreSQL").

**Стандартная структура роли:**
```text
my-role/
├── tasks/          # main.yml - Основной список задач
├── handlers/       # main.yml - Обработчики событий
├── defaults/       # main.yml - Переменные по умолчанию (самый низкий приоритет)
├── vars/           # main.yml - Переменные роли (высокий приоритет)
├── files/          # Статические файлы для модуля copy
├── templates/      # Jinja2 шаблоны для модуля template
└── meta/           # main.yml - Зависимости от других ролей
```

## Collections (Коллекции)

Коллекция — это формат упаковки и распространения контента Ansible. Она может содержать:
*   Роли
*   Модули (Python-код)
*   Плагины (filter, lookup, connection)

С версии 2.10 "батарейки" (модули) были вынесены из ядра Ansible в коллекции.
*   `ansible.builtin` — встроенные модули (copy, file, shell).
*   `community.docker` — модули для Docker.
*   `amazon.aws` — модули для AWS.

Установка: `ansible-galaxy collection install community.docker`
