---
title: "3 Управление образами"
description: "Работа с образами: поиск, скачивание, удаление, offline-передача и современные методы сборки через Buildx."
---

Образы (Images) — это неизменяемые шаблоны, из которых запускаются контейнеры. Умение управлять ими критично для экономии места на диске и переноса приложений в закрытые контуры.

## Основные команды (CLI)

### Поиск и Скачивание
*   **Скачать образ:**
    ```bash
    docker pull postgres:16-alpine
    ```
    *Совет:* Всегда указывайте конкретный тег (`16-alpine`). Тег `latest` непредсказуем и может сломать прод.
*   **Список локальных образов:**
    ```bash
    docker images
    ```

### Удаление и Очистка
Образы "слоистые" и занимают много места.
*   **Удалить конкретный образ:**
    ```bash
    docker rmi python:3.9-slim
    ```
    *Если пишет "image is being used...", значит, нужно сначала остановить и удалить контейнеры, использующие этот образ.*

*   **Очистка мусора (Prune):**
    ```bash
    # Удалить "dangling" (висячие) образы (тег <none>, остались после пересборки)
    docker image prune

    # Удалить ВООБЩЕ ВСЕ образы, которые сейчас не используются запущенными контейнерами
    # (Осторожно! Удалит и базовые образы, придется качать заново)
    docker image prune -a
    ```

## Современная сборка (Buildx)
Команда `docker build` сейчас является алиасом к новому движку **BuildKit (через Buildx)**. Он быстрее, поддерживает кэширование и параллельную сборку.

### Простая сборка
```bash
docker build -t my-app:v1 .
```
*   `-t my-app:v1`: Задает имя и тег.
*   `.`: Контекст сборки (текущая папка, где лежит Dockerfile).

### Мультиплатформенная сборка (Cross-compilation)
Как собрать образ для Raspberry Pi (ARM64) на Mac/PC (AMD64)?
```bash
docker buildx build \
  --platform linux/amd64,linux/arm64 \
  -t my-app:universal \
  --push .
```
*   Требует предварительной настройки: `docker buildx create --use`.
*   Позволяет создавать единый тег, который работает на любой архитектуре процессора.

## Работа в Offline (Air-gapped)
Как перенести образ на сервер, где нет интернета?

1.  **На машине с интернетом (Export):**
    Сохраняем образ в обычный `.tar` архив.
    ```bash
    docker save -o my-images.tar nginx:alpine postgres:16
    ```
    *Можно сохранить несколько образов в один архив.*

2.  **Перенос:** Копируем файл на флешку или через `scp`.

3.  **На закрытом сервере (Import):**
    Загружаем образы из архива в локальный Docker.
    ```bash
    docker load -i my-images.tar
    ```
