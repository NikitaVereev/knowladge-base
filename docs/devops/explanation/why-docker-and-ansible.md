---
title: "Зачем Docker и Ansible"
description: "Почему контейнеризация и конфигурационное управление решают разные задачи и дают предсказуемые деплои при совместном использовании."
---


Docker и Ansible решают разные классы проблем: Docker отвечает за упаковку и запуск приложения в воспроизводимой среде, а Ansible — за приведение инфраструктуры к нужному состоянию и повторяемые операции на множестве хостов.

## Проблема «среда не совпадает»

Код часто пишется локально, а запускается на сервере или в облаке — и различия в версиях языков, зависимостей и системных библиотек быстро приводят к ошибкам «локально работает, на сервере нет».

Дополнительные сложности появляются, когда на одном хосте живут несколько приложений: конкуренция за порты, конфликты зависимостей (например, Python 3.8 vs Python 3.11), ручные правки конфигов и трудный откат.

## Что даёт Docker

Docker упаковывает приложение и его зависимости в образ, а контейнер запускает этот образ в изолированной среде.

Ключевые эффекты:
- Изоляция: приложения меньше мешают друг другу (зависимости, процессы, сетевое окружение).
- Воспроизводимость: одинаковое поведение на машине разработчика, на сервере и в CI.
- Быстрый откат: возврат к предыдущей версии — это запуск контейнера из старого образа.
- Масштабирование экземпляров: проще запускать несколько копий одного сервиса.
- Доставка: вместо «установи 20 пакетов» переносится один артефакт — образ.

## Что даёт Ansible

Docker отвечает на вопрос «как запускать приложение», но не закрывает задачи эксплуатации: подготовка хостов, установка пакетов, раздача конфигов, управление пользователями и доступами, регулярные операции и проверки.

Ansible полезен, когда нужно:
- Привести множество серверов к одному состоянию (пакеты, конфиги, сервисы).
- Описывать инфраструктуру как код (YAML), хранить в Git и воспроизводить.
- Делать деплой/перекат/настройку предсказуемо и повторяемо.
- Автоматизировать проверку результата (например, сервис поднят, endpoint отвечает).

## Почему вместе

Docker стандартизирует среду приложения, а Ansible стандартизирует среду хостов и процесс изменений.

| Задача | Docker | Ansible |
|---|---|---|
| Упаковка приложения и зависимостей | Да | Нет |
| Запуск/перезапуск контейнера, политика обновления | Да | Да (как оркестрация действий) |
| Установка Docker/Compose на хосты | Нет | Да |
| Раздача конфигов, secrets, файрвол, системные настройки | Ограниченно | Да |
| Массовые изменения на N серверах | Ограниченно | Да |

## Минимальная ментальная модель

- Dockerfile описывает, **как собрать** образ приложения.
- Образ — артефакт, который можно хранить в registry и разворачивать где угодно.
- Ansible playbook описывает, **какое состояние** должно быть на хостах (включая запуск контейнеров нужных версий и раскладку конфигурации).

## Связанные материалы

- [[devops/docker]]
- [[devops/ansible]]
- [[tools/git]]
- [[tools/ssh]]
- [[tools/environments/vagrant]]
