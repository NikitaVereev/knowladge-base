---
title: "2 Архитектура Ansible"
description: "Как работает Ansible: Control Node, Managed Nodes, инвентарь и процесс выполнения модулей."
---

Ansible использует архитектуру "Push": управляющий узел подключается к целевым серверам и "толкает" (push) туда конфигурацию.

## Компоненты

### 1. Control Node (Управляющий узел)
Компьютер или сервер, где установлен Ansible и хранятся playbooks.
* **Требования:** Linux/macOS (Windows не поддерживается нативно, используйте WSL2), Python 3.10+.
* Отсюда запускаются команды `ansible`, `ansible-playbook`.

### 2. Managed Nodes (Управляемые узлы)
Серверы, которые вы настраиваете (Target Hosts).
* **Требования:** SSH-сервер, Python 2.7+ или 3.5+ (для выполнения модулей).
* Ansible не оставляет на них никаких демонов после завершения работы.

### 3. Inventory (Инвентарь)
База данных хостов. Может быть статическим файлом (`hosts.yaml`) или динамическим скриптом (плагин для AWS/GCP).

### 4. Modules (Модули)
Небольшие программы (обычно на Python), которые выполняют работу.
* Ansible копирует модуль на удаленный сервер.
* Запускает его.
* Удаляет модуль.

## Процесс выполнения Playbook

1.  **Парсинг:** Ansible читает YAML-конфигурацию и инвентарь.
2.  **Подключение:** Устанавливает SSH-соединение с каждым хостом.
3.  **Gather Facts:** Собирает информацию о системе (OS, IP, CPU, RAM) в переменные `ansible_facts`.
4.  **Task Execution:** Для каждой задачи в списке:
    *   Генерирует автономный Python-скрипт с параметрами задачи.
    *   Копирует скрипт на целевой сервер (обычно в `~/.ansible/tmp`).
    *   Исполняет скрипт (через Python интерпретатор на удаленном хосте).
    *   Получает JSON-ответ (Success/Failed/Changed).
    *   Удаляет временный файл.
