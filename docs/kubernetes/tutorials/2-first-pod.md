---
title: 2 Первый Pod
type: tutorial
tags: [kubernetes, pod, kubectl, yaml, imperative]
---

# 2. Первый Pod

В этом уроке вы запустите ваше первое приложение в кластере Kubernetes и познакомитесь с базовым строительным блоком — **Pod**.

**Цель:** Запустить Pod двумя способами (императивно и декларативно), изучить его структуру и научиться проверять состояние.

---

## Что такое Pod?
Pod — это минимальная развертываемая единица в Kubernetes. Это "обертка" вокруг одного или нескольких контейнеров, которые:
*   Делят один IP-адрес.
*   Могут общаться через `localhost`.
*   Имеют общий жизненный цикл (запускаются и умирают вместе).

В 95% случаев в поде находится **один** контейнер. Несколько контейнеров используются для паттерна Sidecar (например, основное приложение + логгер).

---

## Шаг 1: Императивный запуск (Быстрый старт)

Запустим веб-сервер Nginx через одну команду.

```bash
kubectl run nginx --image=nginx:1.27
```

**Что произошло:**
*   Kubernetes создал объект Pod с именем `nginx`.
*   Назначил его на доступную ноду (Minikube).
*   Запустил контейнер на основе образа `nginx:1.27`.

### Проверка состояния
```bash
kubectl get pods
```

Вывод:
```text
NAME    READY   STATUS    RESTARTS   AGE
nginx   1/1     Running   0          12s
```

*   **READY:** `1/1` — один контейнер из одного запущен.
*   **STATUS:** `Running` — под работает. Другие статусы: `Pending` (ждет ноду), `CrashLoopBackOff` (падает постоянно).

### Детальная информация
Чтобы увидеть события (Events) и полную информацию:
```bash
kubectl describe pod nginx
```

Обратите внимание на секции:
*   **IP:** Внутренний IP-адрес пода.
*   **Node:** На какой ноде он запущен.
*   **Events:** Журнал действий (скачал образ, создал контейнер, запустил).

---

## Шаг 2: Декларативный запход (Production Way)

Императивная команда хороша для экспериментов, но в реальной работе нужны **манифесты** (YAML-файлы).

### Генерация шаблона
Создадим манифест, не применяя его к кластеру (dry-run):
```bash
kubectl run nginx-yaml --image=nginx:1.27 --dry-run=client -o yaml > pod.yaml
```

Откройте файл `pod.yaml`:
```yaml
apiVersion: v1
kind: Pod
metadata:
  name: nginx-yaml
spec:
  containers:
  - name: nginx-yaml
    image: nginx:1.27
```

### Применение манифеста
```bash
kubectl apply -f pod.yaml
```

Проверьте:
```bash
kubectl get pods
```

Теперь у вас **два** пода: `nginx` (созданный императивно) и `nginx-yaml` (из манифеста).

---

## Шаг 3: Доступ к приложению

Nginx слушает на порту 80 внутри контейнера. Но извне кластера вы не можете достучаться напрямую, так как у пода **приватный** IP.

### Port-forward (Проброс порта)
Временный способ открыть доступ с вашего компьютера:
```bash
kubectl port-forward nginx 8080:80
```

Откройте браузер: `http://localhost:8080`
Вы увидите стандартную страницу Nginx "Welcome to nginx!".

Остановите проброс: `Ctrl+C`.

---

## Шаг 4: Логи и отладка

### Чтение логов
```bash
kubectl logs nginx
```

Вы увидите access log Nginx. Если контейнер постоянно падает, можно посмотреть логи предыдущего запуска:
```bash
kubectl logs nginx --previous
```

### Вход внутрь контейнера
Зайдите в контейнер интерактивно (как `docker exec -it`):
```bash
kubectl exec -it nginx -- /bin/bash
```

Внутри можете выполнить:
```bash
cat /etc/nginx/nginx.conf
exit
```

---

## Шаг 5: Очистка

Удалите созданные поды:
```bash
kubectl delete pod nginx
kubectl delete -f pod.yaml
```

Проверьте:
```bash
kubectl get pods
```

Ответ: `No resources found in default namespace.`

---

## Важное замечание
Поды **не предназначены** для прямого использования в production. Если под упадет, он не перезапустится автоматически. Для этого используются **контроллеры** (Deployment, ReplicaSet), о которых мы узнаем в следующем уроке.

---

## Следующий шаг
Вы научились запускать и проверять поды. Теперь перейдем к более надежному способу управления приложениями через Deployment.

Перейти к уроку: [[devops/kubernetes/tutorials/3-deployment-scale|3. Deployment и масштабирование]]
